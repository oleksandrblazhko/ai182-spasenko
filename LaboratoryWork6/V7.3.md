## V7.3 Захист журналу
Журнали, які можна тривіально змінити або видалити, марні для розслідувань і судових переслідувань. Розкриття журналів
може відкрити внутрішні деталі програми або дані, які вона містить. Необхідно бути обережним при захисті колод
від несанкціонованого розголошення, зміни чи видалення.
|#|Опис|L1|L2|L3|CWE|
|----|----|----|----|----|----|
|7.3.1|Переконайтеся, що всі компоненти журналювання належним чином кодують дані для запобігання журналу ін'єкція.(C9)||✓|✓|117|
|7.3.2|[ВИДАЛЕНО, ДУБЛІКАТ 7.3.1]||||
|7.3.3|Переконайтеся, що журнали безпеки захищені від несанкціонованого доступу та модифікація. (C9)||✓|✓|200|
|7.3.4|Переконайтеся, що джерела часу синхронізовано з правильним часом і часовим поясом. Наполегливо розглядайте можливість ведення журналу лише за UTC, якщо системи є глобальними, щоб допомогти у судово-медичному аналізі після інциденту. (C9)||✓|✓|

### C9: Впровадити журнал безпеки та моніторинг
#### опис
Ведення журналу — це концепція, яку більшість розробників вже використовують для налагодження та діагностики. Ведення журналу безпеки є такою ж основною концепцією: реєструвати інформацію про безпеку під час виконання програми. Моніторинг — це перегляд програм і журналів безпеки в реальному часі за допомогою різних форм автоматизації. Ті самі інструменти та шаблони можна використовувати для операцій, налагодження та безпеки.

#### Переваги ведення журналів безпеки
Журнал безпеки можна використовувати для:

#### Системи виявлення вторгнень
Судово-медичний аналіз і дослідження
Відповідає нормативним вимогам
Впровадження журналу безпеки
Нижче наведено список найкращих методів впровадження журналу безпеки.

Дотримуйтеся загального формату журналювання та підходу в системі та між системами організації. Прикладом загальної системи журналювання є служба журналювання Apache, яка допомагає забезпечити узгодженість журналювання між програмами Java, PHP, .NET і C++.
Не записуйте занадто багато або занадто мало. Наприклад, переконайтеся, що завжди реєструєте мітку часу та ідентифікаційну інформацію, включаючи вихідну IP-адресу та ідентифікатор користувача, але будьте обережні, щоб не реєструвати приватні чи конфіденційні дані.
Зверніть особливу увагу на синхронізацію часу між вузлами, щоб переконатися, що мітки часу узгоджені.
Ведення журналів для виявлення та реагування на вторгнення
Використовуйте журналювання, щоб визначити дії, які вказують на те, що користувач поводиться зловмисно. Потенційно зловмисна діяльність для реєстрації включає:

#### Надіслані дані виходять за межі очікуваного числового діапазону.
Надіслані дані, які містять зміни в даних, які не можна змінювати (список вибору, прапорець або інший компонент обмеженого введення).
Запити, які порушують правила контролю доступу на стороні сервера.
Більш вичерпний список можливих точок виявлення доступний тут.
Коли ваша програма стикається з такою активністю, ваша програма має принаймні зареєструвати цю активність і позначити її як проблему високого рівня серйозності. В ідеалі ваша програма також має реагувати на можливу виявлену атаку, наприклад, анулюючи сеанс користувача та блокуючи обліковий запис користувача. Механізми відповіді дозволяють програмному забезпеченню реагувати в реальному часі на можливі виявлені атаки.

#### Дизайн безпечного журналювання
Рішення для журналювання мають створюватися та керуватися безпечним способом. Конструкція безпечного журналювання може включати наступне:

Кодуйте та перевіряйте будь-які небезпечні символи перед входом, щоб запобігти атакам ін’єкції журналу.
Не записуйте конфіденційну інформацію. Наприклад, не реєструйте пароль, ідентифікатор сеансу, кредитні картки або номери соціального страхування.
Захистити цілісність журналу. Зловмисник може спробувати підробити журнали. Тому слід розглянути дозвіл файлів журналу та аудит змін журналу.
Пересилайте журнали з розподілених систем до центральної безпечної служби журналювання. Це гарантує, що дані журналу не можуть бути втрачені, якщо один вузол скомпрометовано. Це також дозволяє здійснювати централізований моніторинг.

## CWE-117: Неправильна нейтралізація вихідних даних для журналів
ID слабкого місця: 117

### Опис
Продукт не нейтралізує або неправильно нейтралізує вихідні дані, записані в журнали.
### Розширений опис
Це може дозволити зловмиснику підробляти записи журналу або вводити шкідливий вміст у журнали.

### Уразливості підробки журналів виникають, коли:

- Дані надходять у програму з ненадійного джерела.
- Дані записуються в файл журналу програми або системи.


## CWE-200: Розкриття конфіденційної інформації несанкціонованому учаснику
ID слабкого місця: 200

### Опис
Продукт надає конфіденційну інформацію суб’єкту, який не має явного дозволу на доступ до цієї інформації.
### Розширений опис
Існує багато різних типів помилок, які спричиняють викриття інформації. Ступінь серйозності помилки може варіюватися в широкому діапазоні залежно від контексту, в якому працює продукт, типу конфіденційної інформації, яка розкривається, і переваг, які вона може надати зловмиснику. Деякі види конфіденційної інформації включають:

приватну особисту інформацію, таку як особисті повідомлення, фінансові дані, медичні записи, географічне розташування або контактні дані
стан системи та середовище, як-от операційна система та встановлені пакети
комерційна таємниця та інтелектуальна власність
статус і конфігурацію мережі
власний код продукту або внутрішній стан
метадані, напр. журналювання підключень або заголовків повідомлень
непряма інформація, така як невідповідність між двома внутрішніми операціями, яку може спостерігати стороння особа
Інформація може бути конфіденційною для різних сторін, кожна з яких може мати власні очікування щодо того, чи потрібно захищати інформацію. Ці сторони включають:

власні користувачі продукту
люди чи організації, чию інформацію створює або використовує продукт, навіть якщо вони не є прямими користувачами продукту
адміністратори продукту, включаючи адміністраторів систем(и) та/або мереж, у яких працює продукт
розробник

### Інформаційний вплив може відбуватися різними способами:

код явно вставляє конфіденційну інформацію до ресурсів або повідомлень, які навмисно зроблені доступними для неавторизованих суб’єктів, але не повинні містити інформацію, тобто інформація повинна бути «очищена» або «продезінфікована»
інший недолік або помилка опосередковано вставляє конфіденційну інформацію до ресурсів, наприклад помилка веб-скрипту, що розкриває повний системний шлях програми.
код керує ресурсами, які навмисно містять конфіденційну інформацію, але ресурси ненавмисно стають доступними для неавторизованих учасників. У цьому випадку розкриття інформації є результуючим, тобто інша слабкість уможливила доступ до інформації в першу чергу.
Поширеною практикою є опис будь-якої втрати конфіденційності як «розкриття інформації», але це може призвести до надмірного використання CWE-200 у відображенні CWE. З точки зору CWE, втрата конфіденційності є технічним впливом, який може виникнути через десятки різних слабких місць, таких як незахищені дозволи на файли або читання поза межами. CWE-200 і його нащадки нижчого рівня призначені для покриття помилок, які виникають у поведінці, яка явно керує, зберігає, передає або очищає конфіденційну інформацію.

### Альтернативні умови
#### Розкриття інформації:
Цей термін часто використовується в рекомендаціях щодо вразливості для опису наслідків або технічного впливу для будь-якої вразливості, яка має втрату конфіденційності. Часто CWE-200 можна неправильно використовувати, щоб показати втрату конфіденційності, навіть якщо помилка (тобто слабкість) не пов’язана безпосередньо з неправильною обробкою самої інформації, як-от зчитування поза межами, яке отримує доступ до конфіденційної пам’яті. вміст; тут читання поза межами є основною слабкістю, а не розкриттям пам’яті. Крім того, ця фраза також часто використовується в політиках і юридичних документах, але вона не стосується будь-якого розкриття інформації, що стосується безпеки.
#### Витік інформації:
Це часто використовуваний термін, однак термін «витік» має багаторазове використання в системі безпеки. У деяких випадках це пов’язано з випадковим розкриттям інформації через інше слабке місце, але в інших випадках (наприклад, «витік пам’яті») це стосується неправильного відстеження ресурсів, що може призвести до виснаження. У результаті CWE активно уникає використання терміну «витік».
