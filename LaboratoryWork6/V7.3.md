## V7.3 Захист журналу
Журнали, які можна тривіально змінити або видалити, марні для розслідувань і судових переслідувань. Розкриття журналів
може відкрити внутрішні деталі програми або дані, які вона містить. Необхідно бути обережним при захисті колод
від несанкціонованого розголошення, зміни чи видалення.
|#|Опис|L1|L2|L3|CWE|
|----|----|----|----|----|----|
|7.3.1|Переконайтеся, що всі компоненти журналювання належним чином кодують дані для запобігання журналу ін'єкція.(C9)||✓|✓|117|
|7.3.2|[ВИДАЛЕНО, ДУБЛІКАТ 7.3.1]||||
|7.3.3|Переконайтеся, що журнали безпеки захищені від несанкціонованого доступу та модифікація. (C9)||✓|✓|200|
|7.3.4|Переконайтеся, що джерела часу синхронізовано з правильним часом і часовим поясом. Наполегливо розглядайте можливість ведення журналу лише за UTC, якщо системи є глобальними, щоб допомогти у судово-медичному аналізі після інциденту. (C9)||✓|✓|

### C9: Впровадити журнал безпеки та моніторинг
#### опис
Ведення журналу — це концепція, яку більшість розробників вже використовують для налагодження та діагностики. Ведення журналу безпеки є такою ж основною концепцією: реєструвати інформацію про безпеку під час виконання програми. Моніторинг — це перегляд програм і журналів безпеки в реальному часі за допомогою різних форм автоматизації. Ті самі інструменти та шаблони можна використовувати для операцій, налагодження та безпеки.

#### Переваги ведення журналів безпеки
Журнал безпеки можна використовувати для:

#### Системи виявлення вторгнень
Судово-медичний аналіз і дослідження
Відповідає нормативним вимогам
Впровадження журналу безпеки
Нижче наведено список найкращих методів впровадження журналу безпеки.

Дотримуйтеся загального формату журналювання та підходу в системі та між системами організації. Прикладом загальної системи журналювання є служба журналювання Apache, яка допомагає забезпечити узгодженість журналювання між програмами Java, PHP, .NET і C++.
Не записуйте занадто багато або занадто мало. Наприклад, переконайтеся, що завжди реєструєте мітку часу та ідентифікаційну інформацію, включаючи вихідну IP-адресу та ідентифікатор користувача, але будьте обережні, щоб не реєструвати приватні чи конфіденційні дані.
Зверніть особливу увагу на синхронізацію часу між вузлами, щоб переконатися, що мітки часу узгоджені.
Ведення журналів для виявлення та реагування на вторгнення
Використовуйте журналювання, щоб визначити дії, які вказують на те, що користувач поводиться зловмисно. Потенційно зловмисна діяльність для реєстрації включає:

#### Надіслані дані виходять за межі очікуваного числового діапазону.
Надіслані дані, які містять зміни в даних, які не можна змінювати (список вибору, прапорець або інший компонент обмеженого введення).
Запити, які порушують правила контролю доступу на стороні сервера.
Більш вичерпний список можливих точок виявлення доступний тут.
Коли ваша програма стикається з такою активністю, ваша програма має принаймні зареєструвати цю активність і позначити її як проблему високого рівня серйозності. В ідеалі ваша програма також має реагувати на можливу виявлену атаку, наприклад, анулюючи сеанс користувача та блокуючи обліковий запис користувача. Механізми відповіді дозволяють програмному забезпеченню реагувати в реальному часі на можливі виявлені атаки.

#### Дизайн безпечного журналювання
Рішення для журналювання мають створюватися та керуватися безпечним способом. Конструкція безпечного журналювання може включати наступне:

Кодуйте та перевіряйте будь-які небезпечні символи перед входом, щоб запобігти атакам ін’єкції журналу.
Не записуйте конфіденційну інформацію. Наприклад, не реєструйте пароль, ідентифікатор сеансу, кредитні картки або номери соціального страхування.
Захистити цілісність журналу. Зловмисник може спробувати підробити журнали. Тому слід розглянути дозвіл файлів журналу та аудит змін журналу.
Пересилайте журнали з розподілених систем до центральної безпечної служби журналювання. Це гарантує, що дані журналу не можуть бути втрачені, якщо один вузол скомпрометовано. Це також дозволяє здійснювати централізований моніторинг.
