### V7.4 Обробка помилок
Мета обробки помилок полягає в тому, щоб дозволити додатку надавати важливі для безпеки події для моніторингу,
сортування та ескалація. Метою є не створення журналів. Під час реєстрації подій, пов’язаних із безпекою, переконайтеся, що
є мета журналу, і що його можна розрізнити за допомогою SIEM або програмного забезпечення для аналізу.

|#|Опис|L1|L2|L3|CWE|
|----|----|----|----|----|----|
|7.4.1|Переконайтеся, що загальне повідомлення відображається, коли несподіване або безпека виникає конфіденційна помилка, потенційно з унікальним ідентифікатором, який підтримує персонал можна використовувати для дослідження. (C10)|✓|✓|✓|210|
|7.4.2|Перевірте, чи використовується обробка винятків (або функціональний еквівалент). кодової бази для врахування очікуваних і неочікуваних умов помилки. (C10)||✓|✓|544|
|7.4.3|Перевірте, чи визначено обробник помилок «останньої інстанції», який перехопить усі необроблені винятки. (C10)||✓|✓|431|

### C10: Обробка всіх помилок і винятків

#### опис
Обробка особливих ситуацій — це концепція програмування, яка дозволяє програмі різними способами реагувати на різні стани помилок (наприклад, несправність мережі, збій підключення до бази даних тощо). Правильна обробка винятків і помилок має вирішальне значення для надійності та безпеки вашого коду.

Обробка помилок і винятків відбувається в усіх областях програми, включаючи критично важливу бізнес-логіку, а також функції безпеки та код інфраструктури.

Обробка помилок також важлива з точки зору виявлення вторгнень. Певні атаки на вашу програму можуть викликати помилки, які можуть допомогти виявити поточні атаки.

#### Помилки обробки помилок
Дослідники з Університету Торонто виявили, що навіть невеликі помилки в обробці помилок або забуття обробки помилок можуть призвести до катастрофічних збоїв у розподілених системах.

#### Помилки в обробці помилок можуть призвести до різних типів вразливостей безпеки.

Витік інформації: витік конфіденційної інформації в повідомленнях про помилки може ненавмисно допомогти зловмисникам. Наприклад, помилка, яка повертає трасування стека або інші деталі внутрішньої помилки, може надати зловмиснику інформацію про ваше середовище. Навіть невеликі відмінності в обробці різних умов помилки (наприклад, повернення «недійсний користувач» або «недійсний пароль» у разі помилок автентифікації) можуть надати цінні підказки для зловмисників. Як описано вище, не забудьте зареєструвати деталі помилок для криміналістики та налагодження, але не надавайте цю інформацію, особливо зовнішньому клієнту.
Обхід TLS: «Помилка переміщення Apple» була помилкою потоку керування в коді обробки помилок, яка призвела до повного порушення з’єднань TLS у системах Apple.
DOS: відсутність базової обробки помилок може призвести до вимкнення системи. Зазвичай це досить легка вразливість для зловмисників. Інші проблеми обробки помилок можуть призвести до збільшення використання ЦП або диска таким чином, що може погіршити роботу системи.
#### Позитивні поради
Централізовано керуйте винятками, щоб уникнути дублювання блоків try/catch у коді. Переконайтеся, що вся несподівана поведінка правильно обробляється всередині програми.
Переконайтеся, що повідомлення про помилки, які відображаються користувачам, не призводять до витоку критичних даних, але все ще є достатньо докладними, щоб забезпечити належну відповідь користувача.
Переконайтеся, що винятки реєструються таким чином, щоб отримати достатньо інформації для підтримки, контролю якості, криміналістики або груп реагування на інциденти, щоб зрозуміти проблему.
Уважно протестуйте та перевірте код обробки помилок.

## CWE-210: самогенероване повідомлення про помилку, що містить конфіденційну інформацію
ID слабкого місця: 210

### Опис
Продукт визначає стан помилки та створює власні діагностичні повідомлення або повідомлення про помилки, які містять конфіденційну інформацію.

##CWE-544: відсутній стандартизований механізм обробки помилок
ID слабкого місця: 544

### Опис
У продукті не використовується стандартизований метод обробки помилок у всьому коді, що може спричинити неузгоджену обробку помилок і відповідні недоліки.
### Розширений опис
Якщо продукт обробляє повідомлення про помилки окремо, по одному, це може призвести до непослідовної обробки помилок. Причини помилок можуть бути втрачені. Крім того, детальна інформація про причини помилки може бути ненавмисно повернена користувачеві.

## CWE-431: відсутній обробник
### Опис
Обробник недоступний або реалізований.
### Розширений опис
Коли виняток викидається та не перехоплюється, це означає, що процес втратив можливість вирішити, чи вартий даний збій або подія зміни у виконанні.
